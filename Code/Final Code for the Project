// Define pins for motor driver
const int in1Pin = 7;
const int in2Pin = 4;
const int in3Pin = 9;
const int in4Pin = 8;
const int enA = 5;
const int enB = 6;

// Define pins for ultrasonic sensor
const int trigPin = 13;
const int echoPin = 3;

// Define pins for IR sensor
const int irPin1 = 2;
const int irPin2 = 10;

// Define variables for ultrasonic sensor
long duration;
int distance;

void forward() {
  digitalWrite(in1Pin, LOW);
  digitalWrite(in2Pin, HIGH);
  digitalWrite(in3Pin, LOW);
  digitalWrite(in4Pin, HIGH);
}
void forwardU() {
  analogWrite(enA, 200);
  analogWrite(enB,200 );
  digitalWrite(in1Pin, LOW);
  digitalWrite(in2Pin, HIGH);
  digitalWrite(in3Pin, LOW);
  digitalWrite(in4Pin, HIGH);
}

void right() {
  analogWrite(enA, 130);
  analogWrite(enB,160 );
  digitalWrite(in1Pin, LOW);
  digitalWrite(in2Pin, HIGH);
  digitalWrite(in3Pin, HIGH);
  digitalWrite(in4Pin, LOW);
}

void stop() {
  digitalWrite(in1Pin, LOW);
  digitalWrite(in2Pin, LOW);
  digitalWrite(in3Pin, LOW);
  digitalWrite(in4Pin, LOW);
}
void left() {
  analogWrite(enA, 160);
  analogWrite(enB,130 );
  digitalWrite(in1Pin, HIGH);
  digitalWrite(in2Pin, LOW);
  digitalWrite(in3Pin, LOW);
  digitalWrite(in4Pin, HIGH);
}
void turn() { 
  analogWrite(enA, 0);
  analogWrite(enB,200 );
  digitalWrite(in1Pin, LOW);
  digitalWrite(in2Pin, LOW);
  digitalWrite(in3Pin, LOW);
  digitalWrite(in4Pin, HIGH);
}

void setup() {
  // Initialize motor driver pins
  pinMode(in1Pin, OUTPUT);
  pinMode(in2Pin, OUTPUT);
  pinMode(in3Pin, OUTPUT);
  pinMode(in4Pin, OUTPUT);
  pinMode(enA, OUTPUT);
  pinMode(enB, OUTPUT);

  // Initialize ultrasonic sensor pins
  pinMode(trigPin, OUTPUT);
  pinMode(echoPin, INPUT);

  // Initialize IR sensor pin
  pinMode(irPin1, INPUT);
  pinMode(irPin2, INPUT);

  // Set initial speed for both motors
  analogWrite(enA, 130);
  analogWrite(enB,130 );
}

void loop() {
  // Read IR sensor input
  int irSensorValue1 = digitalRead(irPin1);
  int irSensorValue2 = digitalRead(irPin2);
analogWrite(enA, 130);
  analogWrite(enB,130 );
  if (irSensorValue1 == 0 && irSensorValue2 == 0) {
    forward();
  } else if (irSensorValue1 == 1 && irSensorValue2 == 0) {
    left();
  } else if (irSensorValue1 == 0 && irSensorValue2 == 1) {
    right();
  
  }

  // Ultrasonic sensor code
  digitalWrite(trigPin, LOW);
  delayMicroseconds(2);
  digitalWrite(trigPin, HIGH);
  delayMicroseconds(7);
  digitalWrite(trigPin, LOW);  
  duration = pulseIn(echoPin, HIGH);
  distance = duration/34.2;
   if(distance==0){
    distance=100;
  }
  if(distance<20)
    {
     left();
      delay(1000);
      forward();
      delay(1700);
      right();
      delay(1200);
     forwardU();
  irSensorValue1 = digitalRead(irPin1);  
  irSensorValue2 = digitalRead(irPin2);
  
while(irSensorValue1 == 0 && irSensorValue2 == 0 ){
   irSensorValue1 = digitalRead(irPin1);
irSensorValue2 = digitalRead(irPin2);
}

  stop();
  delay(2000);
  forwardU();
  delay(100);
   irSensorValue2 = digitalRead(irPin2);
  turn();
  while(irSensorValue2 == 0){
   irSensorValue2 = digitalRead(irPin2);
}
}

}
